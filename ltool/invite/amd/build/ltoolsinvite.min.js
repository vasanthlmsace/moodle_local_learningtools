/**
 * Invite ltool define js.
 * @module   ltool_invite
 * @category  Classes - autoloading
 * @copyright 2021, bdecent gmbh bdecent.de
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("ltool_invite/ltoolsinvite",["jquery","core/modal_factory","core/str","core/fragment","core/modal_events","core/ajax","core/notification"],(function($,ModalFactory,Str,Fragment,ModalEvents,Ajax,notification){function learningToolInviteAction(params){!function(params){var inviteinfo=document.querySelector(".ltoolinvite-info #ltoolinvite-action");if(inviteinfo){inviteinfo.addEventListener("click",(function(){ModalFactory.create({title:params.strinviteusers,body:getInviteAction(params),large:!0}).then((function(modal){modal.show(),modal.getRoot().on(ModalEvents.bodyRendered,(function(){var inviteuserForm=document.querySelector("#invite-users-area form");inviteuserForm&&inviteuserForm.addEventListener("submit",(function(e){e.preventDefault(),function(modal,params){var modalform=document.querySelectorAll("#invite-users-area form")[0],formData=new URLSearchParams(new FormData(modalform)).toString(),jsonparams=JSON.stringify(params);Ajax.call([{methodname:"ltool_invite_inviteusers",args:{params:jsonparams,formdata:formData},done:function(response){if(response){modal.hide();var successinfo=Str.get_string("successinviteusers","local_learningtools");$.when(successinfo).done((function(localizedEditString){notification.addNotification({message:localizedEditString,type:"success"})}));var listurl=M.cfg.wwwroot+"/local/learningtools/ltool/invite/list.php?id="+params.user+"&courseid="+params.course;window.open(listurl,"_self")}else modal.destroy()}}])}(modal,params)}));var saveAction=document.querySelector("#inviteusers-action #save-action");saveAction&&saveAction.addEventListener("click",(function(e){e.preventDefault(),e.target.setAttribute("disabled",!0),document.querySelectorAll("#invite-users-area #inviteuser-action")[0].click()}));var cancelAction=document.querySelector("#inviteusers-action #cancel-action");cancelAction&&cancelAction.addEventListener("click",(function(e){e.preventDefault(),modal.destroy()}))}));var footer=function(params){var content="";content+="<div class='inviteusers-footer' id='inviteusers-footer'>";var listurl=M.cfg.wwwroot+"/local/learningtools/ltool/invite/list.php?id="+params.user+"&courseid="+params.course;params.showreports&&(content+="<div id='list-action-url'><a href='"+listurl+"' target='_blank'>"+params.strinvitelist+"</a></div>");content+="<div id='inviteusers-action' class='inviteusers-action'>",params.showinvitebox&&(content+="<button id='save-action' type='button' class='btn btn-primary' data-action='save'>"+params.strinvitenow+"</button>");return content+="<button id='cancel-action' type='button' class='btn btn-primary' data-action='cancel'>"+params.strcancel+"</button>",content+="</div>",content+="</div>"}(params);return modal.setFooter(footer),modal})).catch(notification.exception)}));var invitehovercolor=inviteinfo.getAttribute("data-hovercolor"),invitefontcolor=inviteinfo.getAttribute("data-fontcolor");invitehovercolor&&invitefontcolor&&inviteinfo.addEventListener("mouseover",(function(){document.querySelector("#ltoolinvite-info p").style.background=invitehovercolor,document.querySelector("#ltoolinvite-info p").style.color=invitefontcolor}))}}(params)}function getInviteAction(params){return Fragment.loadFragment("ltool_invite","get_inviteusers_form",params.contextid,params)}return{init:function(params){learningToolInviteAction(params)}}}));

//# sourceMappingURL=ltoolsinvite.min.js.map