/**
 * forceactivity ltool define js.
 * @module   ltool_forceactivity
 * @category  Classes - autoloading
 * @copyright 2021, bdecent gmbh bdecent.de
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("ltool_forceactivity/forceactivity",["jquery","core/modal_factory","core/str","core/fragment","core/modal_events","core/ajax","core/notification"],(function($,ModalFactory,Str,Fragment,ModalEvents,Ajax,notification){function learningToolforceactivityAction(params){!function(params){var forceactivityinfo=document.querySelector(".ltoolforceactivity-info #ltoolforceactivity-action");if(forceactivityinfo){forceactivityinfo.addEventListener("click",(function(){ModalFactory.create({title:Str.get_string("forceactivity","local_learningtools"),type:ModalFactory.types.SAVE_CANCEL,body:getForceActivityModal(params),large:!0}).then((function(modal){return modal.show(),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault(),$(e.target).find("button[data-action=save]").attr("disabled",!0),modal.getRoot().find("form").submit()})),modal.getRoot().on("submit","form",(e=>{e.preventDefault(),function(modal,params){var modalform=document.querySelectorAll("#forceactivity-modalinfo form")[0],formData=new URLSearchParams(new FormData(modalform)).toString();params=JSON.stringify(params),Ajax.call([{methodname:"ltool_forceactivity_forceactivityaction",args:{params:params,formdata:formData},done:function(response){if(modal.hide(),response){var successinfo=Str.get_string("successforceactivityusers","local_learningtools");$.when(successinfo).done((function(localizedEditString){notification.addNotification({message:localizedEditString,type:"success"})})),0!=ltools.disappertimenotify&&setTimeout((function(){document.querySelector("span.notifications").innerHTML=""}),ltools.disappertimenotify)}}}])}(modal,params)})),modal})).catch(notification.exception)}));var forceactivityhovercolor=forceactivityinfo.getAttribute("data-hovercolor"),forceactivityfontcolor=forceactivityinfo.getAttribute("data-fontcolor");forceactivityhovercolor&&forceactivityfontcolor&&forceactivityinfo.addEventListener("mouseover",(function(){document.querySelector("#ltoolforceactivity-info p").style.background=forceactivityhovercolor,document.querySelector("#ltoolforceactivity-info p").style.color=forceactivityfontcolor}))}}(params)}function getForceActivityModal(params){return Fragment.loadFragment("ltool_forceactivity","get_forceactivitymodal_form",params.contextid,params)}return{init:function(params){learningToolforceactivityAction(params)}}}));

//# sourceMappingURL=forceactivity.min.js.map