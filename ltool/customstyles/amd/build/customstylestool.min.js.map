{"version":3,"file":"customstylestool.min.js","sources":["../src/customstylestool.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Custom styles ltool define js.\n * @module   ltool_customstyles\n * @copyright 2021, bdecent gmbh bdecent.de\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery', 'core/fragment', 'core/modal_factory', 'core/modal_events', 'core/notification'],\n function($, Fragment, ModalFactory, ModalEvents, notification) {\n\n    /**\n     * Controls Custom styles tool action.\n     * @param {object} params\n     */\n    var LearningToolCustomStyles = function(params) {\n        var self = this;\n        var customstylesToolInfo = document.querySelector(\".ltoolcustomstyles-info #ltoolcustomstyles-action\");\n        if (customstylesToolInfo) {\n            // Hover color.\n            var customstylestoolhovercolor = customstylesToolInfo.getAttribute(\"data-hovercolor\");\n            var customstylestoolfontcolor = customstylesToolInfo.getAttribute(\"data-fontcolor\");\n            if (customstylestoolhovercolor && customstylestoolfontcolor) {\n                customstylesToolInfo.addEventListener(\"mouseover\", function() {\n                    document.querySelector('#ltoolcustomstyles-info p').style.background = customstylestoolhovercolor;\n                    document.querySelector('#ltoolcustomstyles-info p').style.color = customstylestoolfontcolor;\n                });\n            }\n            customstylesToolInfo.addEventListener('click', function() {\n                self.displaycustomstylesbox(params);\n            });\n        }\n    };\n\n    LearningToolCustomStyles.prototype.displaycustomstylesbox = function(params) {\n        var self = this;\n        var ltoolcustomstylesbody = document.getElementsByTagName('body')[0];\n        if (!ltoolcustomstylesbody.classList.contains('learningtool-customstyles')) {\n            ltoolcustomstylesbody.classList.add('learningtool-customstyles');\n        }\n        ModalFactory.create({\n            title: params.modalheader,\n            type: ModalFactory.types.SAVE_CANCEL,\n            body: self.getcustomstylesbox(params),\n            large: true\n        }).then(function(modal) {\n\n            modal.show();\n            modal.getRoot().on(ModalEvents.hidden, function() {\n                modal.destroy();\n            });\n            modal.getRoot().on(ModalEvents.save, function(e) {\n                e.preventDefault();\n                $(e.target).find(\"button[data-action=save]\").attr(\"disabled\", true);\n                modal.getRoot().find('form').submit();\n            });\n            modal.getRoot().on(\"submit\", \"form\", e => {\n                e.preventDefault();\n                self.submitFormData(modal, params.contextid);\n            });\n            return modal;\n        }).catch(notification.exception);\n    };\n\n    LearningToolCustomStyles.prototype.submitFormData = function(modal, contextId) {\n        var modalform = document.querySelectorAll('#ltoolcustomstyles-editorbox form')[0];\n        var formData = new URLSearchParams(new FormData(modalform)).toString();\n        var args = {\n            formdata: formData\n        };\n        Fragment.loadFragment('ltool_customstyles', 'save_course_customstyles', contextId, args);\n        modal.hide();\n        window.setTimeout(function() {\n            window.location.reload();\n        }, 500);\n    };\n\n    LearningToolCustomStyles.prototype.getcustomstylesbox = function(params) {\n        return Fragment.loadFragment('ltool_customstyles', 'get_customstyles_editor', params.contextid, params);\n    };\n\n    return {\n        init: function(params) {\n            return new LearningToolCustomStyles(params);\n        }\n    };\n\n });"],"names":["define","$","Fragment","ModalFactory","ModalEvents","notification","LearningToolCustomStyles","params","self","this","customstylesToolInfo","document","querySelector","customstylestoolhovercolor","getAttribute","customstylestoolfontcolor","addEventListener","style","background","color","displaycustomstylesbox","prototype","ltoolcustomstylesbody","getElementsByTagName","classList","contains","add","create","title","modalheader","type","types","SAVE_CANCEL","body","getcustomstylesbox","large","then","modal","show","getRoot","on","hidden","destroy","save","e","preventDefault","target","find","attr","submit","submitFormData","contextid","catch","exception","contextId","modalform","querySelectorAll","args","formdata","URLSearchParams","FormData","toString","loadFragment","hide","window","setTimeout","location","reload","init"],"mappings":";;;;;;AAsBCA,6CAAO,CAAC,SAAU,gBAAiB,qBAAsB,oBAAqB,sBAC9E,SAASC,EAAGC,SAAUC,aAAcC,YAAaC,kBAM1CC,yBAA2B,SAASC,YAChCC,KAAOC,KACPC,qBAAuBC,SAASC,cAAc,wDAC9CF,qBAAsB,KAElBG,2BAA6BH,qBAAqBI,aAAa,mBAC/DC,0BAA4BL,qBAAqBI,aAAa,kBAC9DD,4BAA8BE,2BAC9BL,qBAAqBM,iBAAiB,aAAa,WAC/CL,SAASC,cAAc,6BAA6BK,MAAMC,WAAaL,2BACvEF,SAASC,cAAc,6BAA6BK,MAAME,MAAQJ,6BAG1EL,qBAAqBM,iBAAiB,SAAS,WAC3CR,KAAKY,uBAAuBb,oBAKxCD,yBAAyBe,UAAUD,uBAAyB,SAASb,YAC7DC,KAAOC,KACPa,sBAAwBX,SAASY,qBAAqB,QAAQ,GAC7DD,sBAAsBE,UAAUC,SAAS,8BAC1CH,sBAAsBE,UAAUE,IAAI,6BAExCvB,aAAawB,OAAO,CAChBC,MAAOrB,OAAOsB,YACdC,KAAM3B,aAAa4B,MAAMC,YACzBC,KAAMzB,KAAK0B,mBAAmB3B,QAC9B4B,OAAO,IACRC,MAAK,SAASC,cAEbA,MAAMC,OACND,MAAME,UAAUC,GAAGpC,YAAYqC,QAAQ,WACnCJ,MAAMK,aAEVL,MAAME,UAAUC,GAAGpC,YAAYuC,MAAM,SAASC,GAC1CA,EAAEC,iBACF5C,EAAE2C,EAAEE,QAAQC,KAAK,4BAA4BC,KAAK,YAAY,GAC9DX,MAAME,UAAUQ,KAAK,QAAQE,YAEjCZ,MAAME,UAAUC,GAAG,SAAU,QAAQI,IACjCA,EAAEC,iBACFrC,KAAK0C,eAAeb,MAAO9B,OAAO4C,cAE/Bd,SACRe,MAAM/C,aAAagD,YAG1B/C,yBAAyBe,UAAU6B,eAAiB,SAASb,MAAOiB,eAC5DC,UAAY5C,SAAS6C,iBAAiB,qCAAqC,GAE3EC,KAAO,CACPC,SAFW,IAAIC,gBAAgB,IAAIC,SAASL,YAAYM,YAI5D3D,SAAS4D,aAAa,qBAAsB,2BAA4BR,UAAWG,MACnFpB,MAAM0B,OACNC,OAAOC,YAAW,WACdD,OAAOE,SAASC,WACjB,MAGP7D,yBAAyBe,UAAUa,mBAAqB,SAAS3B,eACtDL,SAAS4D,aAAa,qBAAsB,0BAA2BvD,OAAO4C,UAAW5C,SAG7F,CACH6D,KAAM,SAAS7D,eACJ,IAAID,yBAAyBC"}